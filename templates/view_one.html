<!doctype html>

<head>
    <title>{{ entity['type'] }}: {{ entity.get('code') or entity.get('name') or entity['id'] }}</title>

    <link rel="icon" type="image/png" href="/favicon.png" />
    
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" />
    <link rel="stylesheet" href="//vjs.zencdn.net/c/video-js.css">
    <link rel="stylesheet" type="text/css" href="{{ static('/css/view_one.css') }}" />

    <script>
        var entity_type = {{ entity['type'] | tojson | safe }};
        var entity_id = {{ entity['id'] | tojson | safe }};
        var user_id = {{ session.get('user_id', 0) | int | tojson | safe }};
    </script>

<body>

<ul id="breadcrumb" class="breadcrumb">
    {% for entity in breadcrumbs %}
        <li>
            <small>{{ entity['type'] }}:</small>
            <a href="https://keystone.shotgunstudio.com/detail/{{ entity['type'] }}/{{ entity['id'] }}">
                {{ entity.get('code') or entity.get('name') }}
            </a>
            {% if entity['type'] != 'Version' %}
                <span class="divider">/</span>
            {% endif %}
        </li>
    {% endfor %}
</ul>

<div id="container">
    <video id="video" class="video-js vjs-default-skin" data-setup="{}"
        controls autobuffer preload="auto" autoplay loop>
        <source type="video/mp4" src="{{ video_url }}"></source>
    </video>
</div>

<div id="notes-container">
    <h2>Notes (<span id="notes-count">...</span>):</h2>
    <ol id="notes" class="clearfix">
        <script id="note-template" type="text/x-handlebars-template">{% raw %}
            <li class="note">
                {{#if created_by.image }}
                    <img class="note-created-by-image img-polaroid" src="{{ created_by.image }}" >
                {{/if}}
                <div class="note-content">
                    {{ content }}
                </div>
                <ul class="note-links">
                    {{# each links }}
                        <li class="label label-info">
                            <a href="https://keystone.shotgunstudio.com/detail/{{type}}/{{id}}">
                                {{type}} "{{code}}"
                            </a>
                        </li>
                    {{/each}}
                </ul>
                <div class="note-tagline">
                    Posted by <span class="note-created-by">{{ created_by.name }}</span>
                    at <span class="note-created-at">{{ created_at }}</span>.
                </div>
            </li>
        {% endraw %}</script>

        <li id="note-form-li" class="note">

            <img id="note-form-avatar" class="note-created-by-image img-polaroid hide" >

            <form id="note-form" method="post" action="{{ url_for('new_note_api') }}">
                <fieldset>


                    <input type="hidden" name="version_id" value="{{ latest_version['id'] }}">

                    <textarea name="content" placeholder="Write a new note!"></textarea>
                    <br>
                    <button class="btn btn-primary">Post New Note</button>

                </fieldset>
            </form>

        </li>
    </ol>
</div>


<!-- Scripts load at the very end. -->
<script src="//vjs.zencdn.net/c/video.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.0.rc.2/handlebars.min.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="{{ static('/js/view_one.js') }}"></script>
